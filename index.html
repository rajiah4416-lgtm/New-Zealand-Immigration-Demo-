<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NZ Immigration - Secure ID Portal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --nz-blue: #00247d; --nz-teal: #008477; --nz-red: #cc142d; }
        body { font-family: 'Segoe UI', Arial; background: #cfd8dc; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        
        /* Dashboard */
        .admin-panel { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 30px; width: 100%; max-width: 900px; }
        .grid-inputs { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .input-group { display: flex; flex-direction: column; }
        label { font-size: 10px; font-weight: bold; color: #555; margin-bottom: 4px; }
        input, select { padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 12px; }
        .btn-row { margin-top: 15px; display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; }
        .gen-btn { background: var(--nz-teal); }
        .print-btn { background: var(--nz-blue); }

        /* ID CARD */
        #id-card { width: 540px; height: 340px; background: #fff; border-radius: 15px; position: relative; overflow: hidden; border: 1px solid #aaa; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .card-header { background: var(--nz-blue); height: 75px; padding: 0 20px; display: flex; align-items: center; color: white; }
        .visa-ribbon { background: var(--nz-teal); color: white; padding: 6px 25px; font-weight: bold; font-size: 12px; display: flex; justify-content: space-between; }
        .card-content { display: flex; padding: 20px; gap: 20px; }
        .photo-box { width: 110px; height: 140px; background: #eee; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        #out-photo { width: 100%; height: 100%; object-fit: cover; display: none; }
        .data-side { flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: 8px 15px; }
        .f-label { font-size: 7px; color: #777; font-weight: bold; text-transform: uppercase; }
        .f-val { font-size: 11px; font-weight: 700; color: #111; border-bottom: 1px solid #eee; }
        .qr-box { position: absolute; bottom: 20px; right: 20px; text-align: center; }
        #qrcode { background: white; padding: 4px; border: 1px solid #ddd; }
        .pin-display { position: absolute; bottom: 10px; left: 20px; font-size: 9px; color: var(--nz-red); font-weight: bold; }

        @media print { .admin-panel { display: none; } body { background: white; } }
    </style>
</head>
<body>

    <div class="admin-panel">
        <div class="grid-inputs">
            <div class="input-group"><label>Visa Number</label><input type="text" id="in-visa" value="VN-77665544"></div>
            <div class="input-group"><label>Full Name</label><input type="text" id="in-name" value="ALEX HUNTER"></div>
            <div class="input-group"><label>Job Category</label><input type="text" id="in-job" value="ENGINEER"></div>
            <div class="input-group"><label>Passport No.</label><input type="text" id="in-pass" value="P1234567"></div>
            <div class="input-group"><label>DOB</label><input type="date" id="in-dob" value="1988-05-12"></div>
            <div class="input-group"><label>Gender</label><select id="in-gen"><option>MALE</option><option>FEMALE</option></select></div>
            <div class="input-group"><label>Set Security PIN (4-digit)</label><input type="text" id="in-pin" maxlength="4" value="1234"></div>
            <div class="input-group"><label>Photo</label><input type="file" onchange="preview(event)"></div>
        </div>
        <div class="btn-row">
            <button class="gen-btn" onclick="update()">Encrypt & Update ID</button>
            <button class="print-btn" onclick="window.print()">Print Secure ID</button>
        </div>
    </div>

    <div id="id-card">
        <div class="card-header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Flag_of_New_Zealand.svg" width="70" style="margin-right:15px; border:1px solid #fff;">
            <div>
                <h2 style="margin:0; font-size:16px;">NEW ZEALAND</h2>
                <p style="margin:0; font-size:9px; opacity:0.8;">IMMIGRATION SECURE CREDENTIAL</p>
            </div>
        </div>
        <div class="visa-ribbon"><span>DATA PROTECTED BY ENCRYPTION</span><span id="out-visa">---</span></div>
        <div class="card-content">
            <div class="photo-side">
                <div class="photo-box"><img id="out-photo"></div>
                <div style="margin-top:10px; font-size:9px; font-weight:bold; color:var(--nz-blue);">LEVEL: <span style="color:var(--nz-teal);">RESTRICTED</span></div>
            </div>
            <div class="data-side">
                <div class="field"><div class="f-label">Full Name</div><div class="f-val" id="out-name">---</div></div>
                <div class="field"><div class="f-label">Job Category</div><div class="f-val" id="out-job">---</div></div>
                <div class="field"><div class="f-label">Date of Birth</div><div class="f-val" id="out-dob">---</div></div>
                <div class="field"><div class="f-label">Passport No.</div><div class="f-val" id="out-pass">---</div></div>
            </div>
        </div>
        <div class="qr-box">
            <div id="qrcode"></div>
            <div style="font-size: 6px; font-weight: bold; margin-top: 2px;">SCAN TO UNLOCK DATA</div>
        </div>
        <div class="pin-display">SECURITY PIN: <span id="out-pin">****</span></div>
    </div>

    <script>
        let qr = new QRCode(document.getElementById("qrcode"), { width: 80, height: 80, colorDark : "#00247d" });

        function preview(e) {
            const r = new FileReader();
            r.onload = () => { const o = document.getElementById('out-photo'); o.src = r.result; o.style.display = 'block'; };
            r.readAsDataURL(e.target.files[0]);
        }

        function update() {
            const pin = document.getElementById('in-pin').value;
            const name = document.getElementById('in-name').value;
            const visa = document.getElementById('in-visa').value;
            const job = document.getElementById('in-job').value;
            const dob = document.getElementById('in-dob').value;
            const pass = document.getElementById('in-pass').value;

            // Display on Card
            document.getElementById('out-name').innerText = name.toUpperCase();
            document.getElementById('out-visa').innerText = "VISA: " + visa;
            document.getElementById('out-job').innerText = job;
            document.getElementById('out-dob').innerText = dob;
            document.getElementById('out-pass').innerText = pass;
            document.getElementById('out-pin').innerText = pin;

            // Create a "Verification Page" URL with encoded data
            // In a real scenario, this would be your website. 
            // Here, we simulate the lock by encoding the PIN in the data.
            const dataString = `https://verification-portal.gov.nz/verify?pin=${pin}&name=${btoa(name)}&visa=${visa}&pass=${pass}`;
            
            qr.clear();
            qr.makeCode(dataString);
        }
        update();
    </script>
</body>
</html>
