<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>T.C. İçişleri Bakanlığı | E-İkamet Sistemi</title>
    <style>
        :root { --tr-red: #E30A17; --tr-white: #FFFFFF; --gold: #C5A059; --bg: #0d1117; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; }
        
        /* Navigation */
        nav { background: #161b22; padding: 15px; display: flex; justify-content: center; gap: 15px; border-bottom: 2px solid var(--tr-red); }
        nav button { background: #21262d; border: 1px solid #30363d; color: white; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        nav button.active { background: var(--tr-red); border-color: white; }

        .container { padding: 30px; display: flex; flex-direction: column; align-items: center; }
        .page { display: none; width: 100%; max-width: 900px; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Page 1: Input */
        .admin-card { background: #1c2128; padding: 25px; border-radius: 12px; border: 1px solid #30363d; }
        .grid-input { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        label { display: block; font-size: 0.8rem; color: #8b949e; margin-bottom: 5px; text-transform: uppercase; }
        input { width: 100%; padding: 10px; background: #0d1117; border: 1px solid #444; color: white; border-radius: 4px; box-sizing: border-box; }
        .btn-main { background: var(--tr-red); color: white; border: none; padding: 15px; width: 100%; border-radius: 6px; cursor: pointer; font-weight: bold; margin-top: 20px; }

        /* Page 3: The TRC Card */
        .trc-card {
            width: 480px; height: 300px; background: linear-gradient(135deg, #e1e4e8 0%, #ffffff 100%);
            border-radius: 18px; color: #333; position: relative; border: 1px solid #999;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5); overflow: hidden;
        }
        .trc-header { background: var(--tr-red); padding: 10px 20px; color: white; display: flex; align-items: center; }
        .trc-header img { height: 40px; margin-right: 15px; }
        .trc-body { display: grid; grid-template-columns: 130px 1fr; padding: 20px; gap: 20px; }
        
        #preview-img { width: 110px; height: 140px; background: #eee; border: 2px solid #ccc; object-fit: cover; }
        
        .info-label { font-size: 0.65rem; color: #666; margin: 0; text-transform: uppercase; }
        .info-value { font-size: 0.9rem; font-weight: bold; margin: 0 0 8px 0; color: #000; border-bottom: 1px solid rgba(0,0,0,0.1); }
        
        .watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 6rem; opacity: 0.05; font-weight: bold; pointer-events: none; }
        .stamp-official { position: absolute; bottom: 20px; right: 20px; border: 3px solid #008000; color: #008000; padding: 5px; font-weight: bold; transform: rotate(-10deg); opacity: 0.6; }
    </style>
</head>
<body>

<nav>
    <button id="n1" class="active" onclick="showPage(1)">1. OWNER ENTRY</button>
    <button id="n2" onclick="showPage(2)">2. SECURE DATABASE</button>
    <button id="n3" onclick="showPage(3)">3. DOWNLOAD TRC</button>
</nav>

<div class="container">
    <div id="p1" class="page active">
        <div class="admin-card">
            <h2 style="color: var(--gold);">Authority Portal: TRC Generator</h2>
            <div class="grid-input">
                <div><label>Foreigner ID (YKN)</label><input type="text" id="inID" placeholder="99XXXXXXXXX"></div>
                <div><label>Nationality</label><input type="text" id="inNat" placeholder="e.g., MALAYSIA"></div>
                <div><label>Adı (Name)</label><input type="text" id="inName" placeholder="First Name"></div>
                <div><label>Soyadı (Surname)</label><input type="text" id="inSurname" placeholder="Last Name"></div>
                <div><label>Issue Date</label><input type="date" id="inIssue"></div>
                <div><label>Expiry Date</label><input type="date" id="inExpiry"></div>
            </div>
            <label style="margin-top:15px;">Client Biometric Photo</label>
            <input type="file" id="inPhoto" accept="image/*" onchange="previewFile()">
            <button class="btn-main" onclick="processTRC()">SYNC & AUTHORIZE PERMIT</button>
        </div>
    </div>

    <div id="p2" class="page">
        <div class="admin-card">
            <h3>Registered Foreigner Record</h3>
            <div id="db-content">Fill in the Owner Entry first.</div>
        </div>
    </div>

    <div id="p3" class="page">
        <div class="trc-card" id="trc-capture">
            <div class="watermark">TÜRKİYE</div>
            <div class="trc-header">
                <img src="https://upload.wikimedia.org/wikipedia/commons/b/b4/Flag_of_Turkey.svg" alt="TR Flag">
                <div>
                    <div style="font-weight: bold; font-size: 0.9rem;">TÜRKİYE CUMHURİYETİ</div>
                    <div style="font-size: 0.7rem;">ÇALIŞMA VE SOSYAL GÜVENLİK BAKANLIĞI</div>
                </div>
            </div>
            <div class="trc-body">
                <div>
                    <img id="preview-img" src="#" alt="Photo">
                    <div style="font-size: 0.6rem; margin-top: 10px; color: #999;">KİMLİK NO / ID NO</div>
                    <div id="card-id" style="font-weight: bold;">99...</div>
                </div>
                <div class="info-section">
                    <p class="info-label">Adı / Name</p><p class="info-value" id="card-name">---</p>
                    <p class="info-label">Soyadı / Surname</p><p class="info-value" id="card-surname">---</p>
                    <p class="info-label">Uyruğu / Nationality</p><p class="info-value" id="card-nat">---</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr;">
                        <div><p class="info-label">Veriliş / Issue</p><p class="info-value" id="card-issue">---</p></div>
                        <div><p class="info-label">Son / Expiry</p><p class="info-value" id="card-expiry">---</p></div>
                    </div>
                </div>
            </div>
            <div class="stamp-official">APPROVED / ONAYLANDI</div>
        </div>
        <button class="btn-main" style="background: #21262d; margin-top: 30px;" onclick="window.print()">PRINT / DOWNLOAD AS PDF</button>
    </div>
</div>

<script>
    function showPage(n) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        document.getElementById('p'+n).classList.add('active');
        document.getElementById('n'+n).classList.add('active');
    }

    function previewFile() {
        const preview = document.getElementById('preview-img');
        const file = document.getElementById('inPhoto').files[0];
        const reader = new FileReader();
        reader.onloadend = function () { preview.src = reader.result; }
        if (file) { reader.readAsDataURL(file); }
    }

    function processTRC() {
        const data = {
            id: document.getElementById('inID').value,
            name: document.getElementById('inName').value,
            surname: document.getElementById('inSurname').value,
            nat: document.getElementById('inNat').value,
            issue: document.getElementById('inIssue').value,
            expiry: document.getElementById('inExpiry').value
        };

        // Update Database View
        document.getElementById('db-content').innerHTML = `
            <p><strong>Status:</strong> <span style="color:#00ff88">Active Permission</span></p>
            <p><strong>Full Name:</strong> ${data.name} ${data.surname}</p>
            <p><strong>Nationality:</strong> ${data.nat}</p>
            <p><strong>Issue Date:</strong> ${data.issue}</p>
        `;

        // Update Card View
        document.getElementById('card-id').innerText = data.id || "99000000000";
        document.getElementById('card-name').innerText = data.name.toUpperCase();
        document.getElementById('card-surname').innerText = data.surname.toUpperCase();
        document.getElementById('card-nat').innerText = data.nat.toUpperCase();
        document.getElementById('card-issue').innerText = data.issue;
        document.getElementById('card-expiry').innerText = data.expiry;

        alert("System Synchronized: TRC Authorized.");
        showPage(2);
    }
</script>
</body>
</html>
