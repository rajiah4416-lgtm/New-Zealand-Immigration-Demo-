<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NZ Immigration & HR Sponsorship Suite - Deluxe</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style id="themeStyles">
        :root { --nz-primary: #00247d; --nz-accent: #27ae60; --nz-bg: #2c3e50; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--nz-bg); margin: 0; display: flex; }
        
        .sidebar { width: 380px; background: #1a1a1a; color: white; padding: 25px; height: 100vh; overflow-y: auto; box-sizing: border-box; position: fixed; border-right: 4px solid var(--nz-primary); z-index: 1000; }
        .sidebar h2 { font-size: 13px; color: var(--nz-accent); text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 5px; margin-top: 20px; }
        label { display: block; margin-top: 10px; font-size: 10px; text-transform: uppercase; color: #999; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; border: none; background: #2b2b2b; color: white; font-size: 13px; }
        .color-preview { height: 30px; width: 100%; cursor: pointer; border-radius: 4px; margin-top: 5px; border: 1px solid #444; }

        .preview-area { margin-left: 380px; padding: 40px; width: 100%; display: flex; flex-direction: column; align-items: center; gap: 40px; }
        .a4-page { width: 210mm; min-height: 297mm; background: white; padding: 20mm; box-shadow: 0 0 20px rgba(0,0,0,0.4); box-sizing: border-box; color: #333; position: relative; transition: all 0.3s ease; }

        /* Document Elements */
        .flag-header { text-align: center; margin-bottom: 20px; }
        .nz-flag-img { width: 110px; border: 1px solid #eee; }
        .nz-header { border-bottom: 2px solid #000; text-align: center; padding-bottom: 10px; margin-bottom: 20px; }
        .nz-header h2 { color: var(--nz-primary); transition: color 0.3s; }

        .data-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 12.5px; }
        .data-table td { padding: 8px; border: 1px solid #eee; }
        .label-cell { background: #f8f9fa; font-weight: bold; width: 35%; color: var(--nz-primary); }

        .qr-box { text-align: center; }
        .hr-verification-box { margin-top: 40px; border: 1px solid #ddd; padding: 20px; display: flex; justify-content: space-between; align-items: center; background: #fdfdfd; border-left: 5px solid var(--nz-primary); }

        button.print-btn { width: 100%; padding: 15px; margin-top: 25px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; background: var(--nz-accent); color: white; font-size: 14px; }

        /* Themes */
        .theme-minimalist { border: 10px solid #eee; }
        .theme-modern { border-top: 15px solid var(--nz-primary); }
        .theme-classic { background-image: radial-gradient(#eee 0.5px, transparent 0.5px); background-size: 20px 20px; }

        @media print { .sidebar { display: none; } .preview-area { margin: 0; } .a4-page { box-shadow: none; margin: 0; border: none; } }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>üé® Aesthetic & Theme</h2>
    <label>Select Theme Style</label>
    <select id="themeSelect" onchange="applyTheme()">
        <option value="theme-modern">Modern Professional</option>
        <option value="theme-minimalist">Clean Minimalist</option>
        <option value="theme-classic">Classic Watermark</option>
    </select>

    <label>Primary Brand Color</label>
    <input type="color" id="colorPicker" value="#00247d" oninput="updateColors()">

    <h2>üìÖ Document Timeline</h2>
    <label>Date of Letter Issue</label>
    <input type="date" id="inIssueDate" oninput="sync()">

    <h2>üë§ Personal Details</h2>
    <label>Full Name</label>
    <input type="text" id="inClName" placeholder="John Citizen" oninput="sync()">
    <label>Date of Birth</label>
    <input type="date" id="inDOB" oninput="sync()">
    <label>Passport Number</label>
    <input type="text" id="inClPass" placeholder="PK-123456" oninput="sync()">
    <label>NZ Immigration Ref #</label>
    <input type="text" id="inRef" placeholder="NZ-RES-2026-001" oninput="sync()">

    <h2>üè¢ Company & Job</h2>
    <label>Company Name</label>
    <input type="text" id="inCoName" placeholder="NZ Tech Solutions Ltd" oninput="sync()">
    <label>Job Title</label>
    <input type="text" id="inJob" placeholder="Senior Consultant" oninput="sync()">
    <label>NZ Business Address</label>
    <input type="text" id="inCoAddr" placeholder="123 Queen St, Auckland" oninput="sync()">

    <h2>‚úàÔ∏è Travel Details</h2>
    <label>Pakistan Departure</label>
    <select id="inDepartCity" oninput="sync()">
        <option value="Islamabad Intl (ISB)">Islamabad (ISB)</option>
        <option value="Lahore Allama Iqbal (LHE)">Lahore (LHE)</option>
        <option value="Karachi Jinnah Intl (KHI)">Karachi (KHI)</option>
    </select>
    <label>Arrival Date in NZ</label>
    <input type="date" id="inArriveDate" oninput="sync()">

    <h2>üìã HR Officer</h2>
    <input type="text" id="inHRName" placeholder="Manager Name" oninput="sync()">
    <input type="text" id="inHRPhone" placeholder="Phone Number" oninput="sync()">

    <button class="print-btn" onclick="window.print()">Download / Print Suite</button>
</div>

<div class="preview-area">
    <div class="a4-page theme-modern" id="docPage">
        <div class="flag-header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Flag_of_New_Zealand.svg" class="nz-flag-img">
        </div>

        <div class="nz-header">
            <h2 id="headerTitle">IMMIGRATION NEW ZEALAND</h2>
            <p style="margin:5px 0 0 0; font-size:11px; letter-spacing: 1px;">DATE OF ISSUE: <span class="outIssueDate">Select Date</span></p>
        </div>

        <table class="data-table">
            <tr><td class="label-cell">NZ Immigration Ref</td><td class="outRef" style="font-weight:bold;">REF-PENDING</td></tr>
            <tr><td class="label-cell">Full Name</td><td class="outClName">Client Name</td></tr>
            <tr><td class="label-cell">Date of Birth</td><td class="outDOB">YYYY-MM-DD</td></tr>
            <tr><td class="label-cell">Passport No.</td><td class="outClPass">PK-000000</td></tr>
            <tr><td class="label-cell">Route</td><td><span class="outDepartCity">Islamabad</span> ‚ûî Auckland, NZ</td></tr>
            <tr><td class="label-cell">Arrival Date (NZ)</td><td class="outArriveDate">YYYY-MM-DD</td></tr>
        </table>

        <h3>EMPLOYMENT SPONSORSHIP</h3>
        <table class="data-table">
            <tr><td class="label-cell">Sponsoring Company</td><td class="outCoName" style="font-weight:bold;">Company</td></tr>
            <tr><td class="label-cell">NZ Office Address</td><td class="outCoAddr">Address</td></tr>
            <tr><td class="label-cell">Position Title</td><td class="outJob">Job</td></tr>
        </table>

        <div style="margin-top:20px; padding:15px; border:1px solid #ddd; font-size:11px; line-height:1.5; background:#fff;">
            <strong>CORPORATE GUARANTEE:</strong> <span class="outCoName">The Company</span> formally accepts all sponsorship obligations for the visa holder. This letter was issued on <span class="outIssueDate">Date</span> and is valid for presentation to border authorities.
        </div>

        <div class="hr-verification-box">
            <div>
                <h4 style="margin:0 0 10px 0; color:var(--nz-primary);">HR OFFICER AUTHORIZATION</h4>
                <p style="font-size:12px; margin:2px 0;"><strong>Name:</strong> <span class="outHRName">Pending</span></p>
                <p style="font-size:12px; margin:2px 0;"><strong>Direct Phone:</strong> <span class="outHRPhone">Pending</span></p>
                <div style="border-top:1px solid #000; width:150px; margin-top:20px; font-size:9px;">SIGNATURE & STAMP</div>
            </div>
            <div class="qr-box">
                <div id="hrQRCode"></div>
                <div style="font-size:8px; margin-top:5px; font-weight:bold; color:var(--nz-primary);">SECURE QR VERIFICATION</div>
            </div>
        </div>
    </div>
</div>

<script>
    let hrQR = new QRCode(document.getElementById("hrQRCode"), { width: 90, height: 90 });

    function updateColors() {
        const color = document.getElementById('colorPicker').value;
        document.documentElement.style.setProperty('--nz-primary', color);
    }

    function applyTheme() {
        const theme = document.getElementById('themeSelect').value;
        const page = document.getElementById('docPage');
        page.className = 'a4-page ' + theme;
    }

    function sync() {
        const val = {
            outIssueDate: document.getElementById('inIssueDate').value || 'Not Issued',
            outClName: document.getElementById('inClName').value || 'John Citizen',
            outDOB: document.getElementById('inDOB').value || 'YYYY-MM-DD',
            outClPass: document.getElementById('inClPass').value || 'PK-123456',
            outJob: document.getElementById('inJob').value || 'Position',
            outRef: document.getElementById('inRef').value || 'NZ-REF-XXXX',
            outCoName: document.getElementById('inCoName').value || 'NZ Company Ltd',
            outCoAddr: document.getElementById('inCoAddr').value || 'NZ Address',
            outDepartCity: document.getElementById('inDepartCity').value,
            outArriveDate: document.getElementById('inArriveDate').value || 'YYYY-MM-DD',
            outHRName: document.getElementById('inHRName').value || 'Officer Name',
            outHRPhone: document.getElementById('inHRPhone').value || 'Phone Number'
        };

        for (const [key, value] of Object.entries(val)) {
            document.querySelectorAll('.' + key).forEach(el => el.innerText = value);
        }

        const qrData = `HR-VERIFY|ISSUED:${val.outIssueDate}|REF:${val.outRef}|CO:${val.outCoName}`;
        hrQR.makeCode(qrData);
    }

    // Set default dates to today
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('inIssueDate').value = today;
    document.getElementById('inArriveDate').value = today;
    sync();
</script>
</body>
    </html>
