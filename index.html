<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NZ Immigration Company Authorization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print {
            .no-print { display: none; }
            #letter-output { border: none; box-shadow: none; padding: 0; width: 100%; }
            body { background-color: white; padding: 0; }
        }
        .inz-logo { max-height: 75px; width: auto; }
    </style>
</head>
<body class="bg-slate-100 font-sans p-4 md:p-10">

    <div class="max-w-5xl mx-auto no-print">
        <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 mb-10">
            <h1 class="text-2xl font-bold text-slate-800 mb-6 border-b pb-4">ðŸ‡³ðŸ‡¿ Authorization Letter Generator</h1>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="space-y-4">
                    <h3 class="font-bold text-blue-800 text-xs uppercase tracking-wider">Company Details</h3>
                    <input id="coName" type="text" placeholder="Company Legal Name" class="w-full p-2 border rounded text-sm">
                    <input id="nzbn" type="text" placeholder="NZBN (13 digits)" class="w-full p-2 border rounded text-sm">
                    <input id="address" type="text" placeholder="Company Address" class="w-full p-2 border rounded text-sm">
                    <input id="coEmail" type="email" placeholder="Company Email" class="w-full p-2 border rounded text-sm">
                </div>

                <div class="space-y-4">
                    <h3 class="font-bold text-blue-800 text-xs uppercase tracking-wider">Client (Applicant) Details</h3>
                    <input id="repName" type="text" placeholder="Full Name (as per Passport)" class="w-full p-2 border rounded text-sm">
                    <input id="passport" type="text" placeholder="Passport Number" class="w-full p-2 border rounded text-sm">
                    <input id="dob" type="text" placeholder="Date of Birth (DD/MM/YYYY)" class="w-full p-2 border rounded text-sm">
                    <input id="nationality" type="text" placeholder="Nationality" class="w-full p-2 border rounded text-sm">
                </div>

                <div class="space-y-4">
                    <h3 class="font-bold text-blue-800 text-xs uppercase tracking-wider">Application Details</h3>
                    <input id="visaCat" type="text" placeholder="Visa Category (e.g. AEWV)" class="w-full p-2 border rounded text-sm">
                    <input id="refNo" type="text" placeholder="Reference / Client Number" class="w-full p-2 border rounded text-sm">
                    <input id="director" type="text" placeholder="Authorizing Director" class="w-full p-2 border rounded text-sm">
                </div>
            </div>

            <button onclick="generateLetter()" class="mt-8 bg-slate-900 text-white px-8 py-3 rounded font-bold hover:bg-black transition shadow-lg">
                Generate Document
            </button>
        </div>
    </div>

    <div id="letter-output" class="max-w-4xl mx-auto bg-white p-16 shadow-2xl hidden">
        <div class="flex justify-end no-print mb-4">
            <button onclick="window.print()" class="bg-green-600 text-white px-6 py-2 rounded text-sm font-bold shadow hover:bg-green-700">Print to PDF</button>
        </div>

        <div id="printableArea">
            <div class="flex justify-between items-start border-b-2 border-slate-900 pb-6 mb-8">
                <div>
                    <h2 id="outCoName" class="text-2xl font-bold uppercase text-slate-900">COMPANY NAME</h2>
                    <p class="text-xs">NZBN: <span id="outNZBN"></span></p>
                    <p id="outAddress" class="text-xs text-slate-600 italic"></p>
                    <p id="outCoEmail" class="text-xs text-blue-700"></p>
                </div>
                <img src="https://i.imgur.com/vH9eHwO.png" alt="INZ Logo" class="inz-logo">
            </div>

            <div class="text-right mb-6">
                <p id="outDate" class="font-medium"></p>
            </div>

            <div class="bg-slate-50 border border-slate-200 p-4 mb-8 grid grid-cols-2 gap-y-2 text-sm">
                <div><span class="font-bold text-slate-500 uppercase text-[10px]">Applicant:</span> <p id="outRepName" class="font-bold"></p></div>
                <div><span class="font-bold text-slate-500 uppercase text-[10px]">Passport No:</span> <p id="outPassport" class="font-bold"></p></div>
                <div><span class="font-bold text-slate-500 uppercase text-[10px]">Date of Birth:</span> <p id="outDOB"></p></div>
                <div><span class="font-bold text-slate-500 uppercase text-[10px]">Nationality:</span> <p id="outNationality"></p></div>
                <div><span class="font-bold text-slate-500 uppercase text-[10px]">Visa Category:</span> <p id="outVisaCat"></p></div>
                <div><span class="font-bold text-slate-500 uppercase text-[10px]">Reference No:</span> <p id="outRefNo"></p></div>
            </div>

            <div class="text-slate-900">
                <p class="font-bold mb-6">TO: IMMIGRATION NEW ZEALAND</p>
                <p class="mb-4">To the Visa Processing Officer,</p>
                <p class="mb-6">This letter serves to formally authorize the individual named above to act on behalf of <strong><span class="outCoNamePlain"></span></strong> for all matters related to the specified visa application category.</p>
                
                <p class="mb-4 font-bold">Scope of Authorization:</p>
                <ul class="list-disc ml-8 mb-8 space-y-1 text-sm">
                    <li>Submission of Employer Accreditation and Job Check documentation.</li>
                    <li>Communication with INZ regarding the applicant's status and employment terms.</li>
                    <li>Authority to provide settlement support evidence as required by AEWV policy.</li>
                </ul>

                <p class="mb-12 text-sm leading-relaxed italic">We confirm that all information provided is true and correct to the best of our knowledge, and the company remains compliant with the Immigration Act 2009.</p>

                <div class="mt-20">
                    <div class="w-64 border-t border-black mb-1"></div>
                    <p class="font-bold uppercase" id="outDirector"></p>
                    <p class="text-xs">Director | <span class="outCoNamePlain uppercase text-slate-500"></span></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function generateLetter() {
            const fields = ['coName', 'nzbn', 'address', 'coEmail', 'repName', 'passport', 'dob', 'nationality', 'visaCat', 'refNo', 'director'];
            fields.forEach(f => {
                const val = document.getElementById(f).value || "---";
                const out = document.getElementById('out' + f.charAt(0).toUpperCase() + f.slice(1));
                if (out) out.innerText = val;
            });

            document.querySelectorAll('.outCoNamePlain').forEach(el => el.innerText = document.getElementById('coName').value);
            document.getElementById('outDate').innerText = new Date().toLocaleDateString('en-NZ', { day: 'numeric', month: 'long', year: 'numeric' });
            document.getElementById('letter-output').classList.remove('hidden');
            window.scrollTo({ top: document.getElementById('letter-output').offsetTop, behavior: 'smooth' });
        }
    </script>
</body>
</html>
