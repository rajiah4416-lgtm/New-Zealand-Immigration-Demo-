<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Client Visa System</title>

<style>
body{
font-family:Arial;
margin:0;
background:#f2f4f7;
}

header{
background:#003a8f;
color:white;
padding:15px;
font-size:20px;
}

.container{
padding:20px;
}

.card{
background:white;
padding:20px;
margin-bottom:20px;
border-radius:8px;
box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

input,textarea{
width:100%;
padding:8px;
margin-top:5px;
margin-bottom:15px;
border:1px solid #ccc;
border-radius:4px;
}

button{
background:#003a8f;
color:white;
border:none;
padding:10px 15px;
border-radius:5px;
cursor:pointer;
}

button:hover{
background:#0055cc;
}

table{
width:100%;
border-collapse:collapse;
}

th,td{
padding:10px;
border-bottom:1px solid #ddd;
text-align:left;
}

#letter{
background:white;
padding:40px;
margin-top:20px;
}
</style>

</head>

<body>

<header>
Client Visa Admin System
</header>

<div class="container">

<div class="card">

<h3>Add Client</h3>

<label>Client Name</label>
<input id="name">

<label>Passport</label>
<input id="passport">

<label>Visa Type</label>
<input id="visa">

<label>Upload Visa PDF</label>
<input type="file" id="pdfUpload">

<button onclick="saveClient()">Save Client</button>

</div>


<div class="card">
<h3>Upload Logo</h3>
<input type="file" onchange="uploadLogo(event)">
</div>


<div class="card">

<h3>Client Dashboard</h3>

<table id="clientTable">
<tr>
<th>Name</th>
<th>Passport</th>
<th>Visa</th>
<th>Actions</th>
</tr>
</table>

</div>


<div class="card">

<h3>Visa Letter Preview</h3>

<div id="letter">

<img id="logo" style="height:80px"><br><br>

<h2>Visa Approval Letter</h2>

<p id="letterContent"></p>

</div>

<br>

<button onclick="window.print()">Print Letter</button>
<button onclick="downloadPDF()">Download PDF</button>
<button onclick="downloadZIP()">Export ZIP</button>

</div>

</div>


<script>

let clients = JSON.parse(localStorage.getItem("clients") || "[]");

function saveClient(){

let file = document.getElementById("pdfUpload").files[0];

let reader = new FileReader();

reader.onload = function(){

let client = {
name: name.value,
passport: passport.value,
visa: visa.value,
pdf: reader.result
};

clients.push(client);

localStorage.setItem("clients",JSON.stringify(clients));

loadClients();

};

if(file) reader.readAsDataURL(file);
}

function loadClients(){

let table = document.getElementById("clientTable");

table.innerHTML = `
<tr>
<th>Name</th>
<th>Passport</th>
<th>Visa</th>
<th>Actions</th>
</tr>
`;

clients.forEach((c,i)=>{

table.innerHTML += `
<tr>
<td>${c.name}</td>
<td>${c.passport}</td>
<td>${c.visa}</td>
<td>
<button onclick="viewLetter(${i})">View</button>
<button onclick="deleteClient(${i})">Delete</button>
</td>
</tr>
`;

});

}

function deleteClient(i){
clients.splice(i,1);
localStorage.setItem("clients",JSON.stringify(clients));
loadClients();
}

function viewLetter(i){

let c = clients[i];

letterContent.innerHTML = `
This letter confirms that <b>${c.name}</b>
holding passport number <b>${c.passport}</b>
has been granted a <b>${c.visa}</b> visa.
`;

}

function uploadLogo(e){

let reader = new FileReader();

reader.onload = function(){
localStorage.setItem("logo",reader.result);
document.getElementById("logo").src = reader.result;
};

reader.readAsDataURL(e.target.files[0]);
}

document.getElementById("logo").src = localStorage.getItem("logo");

loadClients();


// PDF DOWNLOAD
function downloadPDF(){

let content = document.getElementById("letter").innerHTML;

let win = window.open("");
win.document.write(content);
win.print();

}


// ZIP EXPORT
function downloadZIP(){

let zipData = JSON.stringify(clients);

let blob = new Blob([zipData],{type:"application/zip"});

let a = document.createElement("a");
a.href = URL.createObjectURL(blob);
a.download = "clients.zip";
a.click();

}

</script>

</body>
</html>
