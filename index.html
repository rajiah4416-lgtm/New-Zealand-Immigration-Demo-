<div id="pdf-export" style="position: absolute; left: -9999px; top: 0; width: 210mm; background: white; overflow: hidden;">
    
    <div class="page" style="page-break-after: always; height: 297mm; position: relative; border-top: 15px solid #00247D; border-bottom: 15px solid #CC142B; padding: 20mm; box-sizing: border-box;">
        <div class="watermark">OFFICIAL DOCUMENT</div>
        <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Flag_of_New_Zealand.svg" class="nz-logo">
        <div class="govt-header">
            <h1 style="margin:0; font-size: 26px; color: var(--nz-blue);">EMPLOYMENT AGREEMENT</h1>
            <p style="margin:0; font-weight:bold; letter-spacing: 2px;">IN ACCORDANCE WITH THE EMPLOYMENT RELATIONS ACT 2000</p>
        </div>
        <div style="border-left: 5px solid var(--nz-red); padding-left: 15px; background: #f9f9f9; padding: 10px;">
            <strong>Ref No:</strong> <span id="out-ref">---</span><br>
            <strong>Date of Issue:</strong> February 15, 2026
        </div>
        <h2>1. PARTIES</h2>
        <table>
            <tr><td class="label">The Employer</td><td id="out-co-name">---</td></tr>
            <tr><td class="label">NZBN / IRD</td><td><span id="out-co-num">---</span> / <span id="out-co-tax">---</span></td></tr>
            <tr><td class="label">Employer Address</td><td id="out-co-addr">---</td></tr>
            <tr><td class="label">The Employee</td><td id="out-name">---</td></tr>
            <tr><td class="label">Passport / DOB</td><td><span id="out-passport">---</span> / <span id="out-dob">---</span></td></tr>
        </table>
        <h2>2. POSITION AND DUTIES</h2>
        <p>The Employer appoints the Employee to the position of <b><span id="out-cat">---</span></b>.</p>
        <h2>3. TYPE OF AGREEMENT</h2>
        <p>This is an **Individual Employment Agreement** for the AEWV scheme.</p>
    </div>

    <div class="page" style="page-break-after: always; height: 297mm; position: relative; border-top: 15px solid #00247D; border-bottom: 15px solid #CC142B; padding: 20mm; box-sizing: border-box;">
        <div class="watermark">NEW ZEALAND LAW</div>
        <h2 style="margin-top:0;">4. REMUNERATION</h2>
        <p>The Employee’s base rate of pay shall be <b><span id="out-salary">---</span> per hour</b>.</p>
        <h2>5. HOURS OF WORK</h2>
        <p>The Employee is guaranteed a minimum of **40 hours per week**.</p>
        <h2>6. HOLIDAYS AND LEAVE</h2>
        <ul>
            <li><b>Annual Leave:</b> 4 weeks’ paid annual holidays.</li>
            <li><b>Sick Leave:</b> 10 days’ paid sick leave per year.</li>
        </ul>
        <h2>7. KIWISAVER</h2>
        <p>Contributions will be made in accordance with the <i>KiwiSaver Act 2006</i>.</p>
    </div>

    <div class="page" style="height: 297mm; position: relative; border-top: 15px solid #00247D; border-bottom: 15px solid #CC142B; padding: 20mm; box-sizing: border-box;">
        <div class="watermark">VALIDATED</div>
        <h2 style="margin-top:0;">8. HEALTH AND SAFETY</h2>
        <p>Compliance with the <i>Health and Safety at Work Act 2015</i> is mandatory.</p>
        <h2>9. CONFIDENTIALITY</h2>
        <p>Protection under the <i>Privacy Act 2020</i> applies.</p>
        <h2>10. EXECUTION</h2>
        <div class="sig-container" style="display: flex; justify-content: space-between; margin-top: 40px;">
            <div class="sig-box" style="width: 45%; border-top: 2px solid #000; text-align: center; padding-top: 10px;">
                <img id="out-sig" style="width:180px; height:70px; object-fit:contain; display:block; margin: 0 auto;">
                <p><b>Employee Signature</b></p>
            </div>
            <div class="sig-box" style="width: 45%; border-top: 2px solid #000; text-align: center; padding-top: 10px;">
                <div style="font-family: cursive; color: #00247D;">Employer Signed</div>
                <p><b>Company Authorized</b></p>
            </div>
        </div>
        <div class="qr-section" style="display: flex; align-items: center; gap: 20px; margin-top: 30px; border: 1px solid #eee; padding: 10px;">
            <img id="out-qr" style="width:100px;">
            <div style="font-size:11px;"><strong>REF:</strong> <span id="out-ref2">---</span></div>
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById('signature-canvas');
    const signaturePad = new SignaturePad(canvas);
    const globalRef = "NZ-AUTH-" + Math.floor(100000 + Math.random() * 899999);

    function sync() {
        const val = (id) => document.getElementById(id).value || '---';
        document.getElementById('out-name').innerText = val('c-name');
        document.getElementById('out-salary').innerText = val('c-salary');
        document.getElementById('out-ref').innerText = globalRef;
        document.getElementById('out-ref2').innerText = globalRef;
        
        // QR Code
        const qrContent = `REF: ${globalRef} | EMP: ${val('c-name')}`;
        document.getElementById('out-qr').src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(qrContent)}`;
    }

    async function download() {
        if (!signaturePad.isEmpty()) {
            document.getElementById('out-sig').src = signaturePad.toDataURL();
        }
        
        const element = document.getElementById('pdf-export');
        const opt = {
            margin: 0,
            filename: `NZ_Agreement_${document.getElementById('c-name').value}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2, useCORS: true },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
            // FORCING strict breaks
            pagebreak: { mode: 'css' }
        };
        
        // Generate PDF
        html2pdf().set(opt).from(element).toPdf().get('pdf').then(function (pdf) {
            // Delete any potential 4th page that the library might have added
            var totalPages = pdf.internal.getNumberOfPages();
            while (totalPages > 3) {
                pdf.deletePage(totalPages);
                totalPages--;
            }
        }).save();
    }
    sync();
</script>
