<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Official NZ Immigration - Secure QR Portal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --nz-blue: #00247d; --nz-red: #cc142d; --nz-teal: #008477; }
        body { font-family: 'Segoe UI', Arial; background: #cfd8dc; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        
        /* Dashboard Control */
        .admin-panel { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin-bottom: 30px; width: 100%; max-width: 900px; }
        .grid-inputs { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .input-group { display: flex; flex-direction: column; }
        label { font-size: 10px; font-weight: bold; color: #555; margin-bottom: 4px; }
        input, select { padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 12px; }
        
        .btn-row { margin-top: 15px; display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; }
        .gen-btn { background: var(--nz-teal); }
        .print-btn { background: var(--nz-blue); }

        /* THE PHYSICAL ID CARD */
        #id-card { width: 540px; height: 340px; background: #fff; border-radius: 15px; position: relative; overflow: hidden; border: 1px solid #aaa; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .card-header { background: var(--nz-blue); height: 75px; padding: 0 20px; display: flex; align-items: center; color: white; }
        .visa-ribbon { background: var(--nz-teal); color: white; padding: 6px 25px; font-weight: bold; font-size: 12px; display: flex; justify-content: space-between; }
        .card-content { display: flex; padding: 20px; gap: 20px; }
        .photo-box { width: 110px; height: 140px; background: #eee; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        #out-photo { width: 100%; height: 100%; object-fit: cover; }
        .data-side { flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: 8px 15px; }
        .f-label { font-size: 7px; color: #777; font-weight: bold; text-transform: uppercase; }
        .f-val { font-size: 11px; font-weight: 700; color: #111; border-bottom: 1px solid #eee; }
        .qr-box { position: absolute; bottom: 20px; right: 20px; text-align: center; }
        #qrcode { background: white; padding: 4px; border: 1px solid #ddd; display: inline-block;}

        /* SECURITY OVERLAY (For scanning simulation) */
        #secure-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 36, 125, 0.98); color: white;
            display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 1000;
        }
        .pin-input-box { background: white; padding: 30px; border-radius: 15px; color: #333; text-align: center; }
        
        @media print { .admin-panel, #secure-overlay { display: none !important; } body { background: white; } }
    </style>
</head>
<body>

    <div class="admin-panel">
        <div class="grid-inputs">
            <div class="input-group"><label>Full Name</label><input type="text" id="in-name" value="SAMUEL JACKSON"></div>
            <div class="input-group"><label>Visa Number</label><input type="text" id="in-visa" value="VN-88220044"></div>
            <div class="input-group"><label>Job Category</label><input type="text" id="in-job" value="SENIOR ARCHITECT"></div>
            <div class="input-group"><label>Passport No.</label><input type="text" id="in-pass" value="NZ9988771"></div>
            <div class="input-group"><label>DOB</label><input type="date" id="in-dob" value="1985-06-15"></div>
            <div class="input-group"><label>Gender</label><select id="in-gen"><option>MALE</option><option>FEMALE</option></select></div>
            <div class="input-group"><label>Security PIN (Code)</label><input type="text" id="in-pin" maxlength="6" value="5566"></div>
            <div class="input-group"><label>Photo</label><input type="file" onchange="preview(event)"></div>
        </div>
        <div class="btn-row">
            <button class="gen-btn" onclick="update()">Apply & Encrypt QR</button>
            <button class="print-btn" onclick="window.print()">Print ID Card</button>
            <button style="background:#555" onclick="simulateScan()">Test Scan Preview</button>
        </div>
    </div>

    <div id="id-card">
        <div class="card-header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Flag_of_New_Zealand.svg" width="70" style="margin-right:15px; border:1px solid #fff;">
            <div>
                <h2 style="margin:0; font-size:16px;">NEW ZEALAND</h2>
                <p style="margin:0; font-size:9px; opacity:0.8;">IMMIGRATION BORDER SERVICE</p>
            </div>
            <img src="https://www.immigration.govt.nz/assets/main-site/logos/inz-logo-footer.png" style="position:absolute; right:20px; height:20px; filter:brightness(0) invert(1);">
        </div>
        <div class="visa-ribbon"><span>ENCRYPTED SECURITY CLEARANCE</span><span id="out-visa">---</span></div>
        <div class="card-content">
            <div class="photo-side">
                <div class="photo-box"><img id="out-photo" src=""></div>
                <div style="margin-top:10px; font-size:10px; font-weight:bold; color:var(--nz-blue);">PORT: AKL</div>
            </div>
            <div class="data-side">
                <div class="field"><div class="f-label">Full Name</div><div class="f-val" id="out-name">---</div></div>
                <div class="field"><div class="f-label">Job Category</div><div class="f-val" id="out-job">---</div></div>
                <div class="field"><div class="f-label">Date of Birth</div><div class="f-val" id="out-dob">---</div></div>
                <div class="field"><div class="f-label">Passport No.</div><div class="f-val" id="out-pass">---</div></div>
            </div>
        </div>
        <div class="qr-box">
            <div id="qrcode"></div>
            <div style="font-size: 6px; font-weight: bold; margin-top: 3px; color:var(--nz-blue)">AUTH REQUIRED</div>
        </div>
        <div style="position:absolute; bottom:10px; left:20px; font-size:7px; color:#aaa;">SECURE PIN PROTECTED SYSTEM</div>
    </div>

    <div id="secure-overlay">
        <div class="pin-input-box">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Flag_of_New_Zealand.svg" width="50">
            <h3>Identity Verification</h3>
            <p style="font-size:12px;">Please enter the <b>Security PIN</b> to view client data.</p>
            <input type="password" id="pin-verify" placeholder="Enter Code" style="text-align:center; font-size:20px; width:150px; margin:10px 0; border:2px solid var(--nz-blue);"><br>
            <button class="gen-btn" onclick="checkPin()">Access Information</button>
            <button style="background:#ccc; color:#333;" onclick="document.getElementById('secure-overlay').style.display='none'">Close</button>
            <div id="error-msg" style="color:red; font-size:12px; margin-top:10px; display:none;">Invalid Security Code</div>
        </div>
    </div>

    <script>
        let qrContainer = document.getElementById("qrcode");
        let qr = new QRCode(qrContainer, { width: 85, height: 85, colorDark : "#00247d" });
        let currentPin = "5566";

        function preview(e) {
            const r = new FileReader();
            r.onload = () => { document.getElementById('out-photo').src = r.result; };
            r.readAsDataURL(e.target.files[0]);
        }

        function update() {
            const v = id => document.getElementById(id).value;
            currentPin = v('in-pin');

            // Update Physical Card
            document.getElementById('out-name').innerText = v('in-name').toUpperCase();
            document.getElementById('out-visa').innerText = "VISA: " + v('in-visa');
            document.getElementById('out-job').innerText = v('in-job');
            document.getElementById('out-dob').innerText = v('in-dob');
            document.getElementById('out-pass').innerText = v('in-pass');

            // In a real website, this QR would link to a URL like yoursite.com/verify?id=123
            // Here we simulate the encoded data for the scanner
            const secretData = `NZ-SECURE-ID|PIN:${currentPin}|NAME:${v('in-name')}|VISA:${v('in-visa')}|PASS:${v('in-pass')}|DOB:${v('in-dob')}|JOB:${v('in-job')}`;
            
            qr.clear();
            qr.makeCode(secretData);
        }

        function simulateScan() {
            document.getElementById('secure-overlay').style.display = 'flex';
            document.getElementById('pin-verify').value = "";
            document.getElementById('error-msg').style.display = 'none';
        }

        function checkPin() {
            const entered = document.getElementById('pin-verify').value;
            if (entered === currentPin) {
                alert(`ACCESS GRANTED\n\nClient: ${document.getElementById('in-name').value}\nVisa: ${document.getElementById('in-visa').value}\nJob: ${document.getElementById('in-job').value}\nPassport: ${document.getElementById('in-pass').value}`);
                document.getElementById('secure-overlay').style.display = 'none';
            } else {
                document.getElementById('error-msg').style.display = 'block';
            }
        }
        update();
    </script>
</body>
</html>
