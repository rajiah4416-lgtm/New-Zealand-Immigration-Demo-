<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NZ Immigration Document Suite</title>
    <style>
        :root { --nz-blue: #00247d; --nz-silver: #c0c0c0; }
        body { font-family: Arial, sans-serif; background: #f0f2f5; margin: 0; display: flex; }
        
        /* Control Panel */
        .sidebar { width: 350px; background: #1c1e21; color: white; padding: 20px; height: 100vh; overflow-y: auto; box-sizing: border-box; position: fixed; }
        .sidebar h2 { font-size: 16px; color: var(--nz-silver); border-bottom: 1px solid #444; padding-bottom: 10px; }
        label { display: block; margin-top: 10px; font-size: 11px; text-transform: uppercase; }
        input, select, textarea { width: 100%; padding: 8px; margin-top: 5px; border-radius: 3px; border: none; font-size: 13px; }
        button { width: 100%; padding: 12px; margin-top: 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; text-transform: uppercase; }
        .btn-print { background: #0084ff; color: white; }

        /* Document Preview Area */
        .preview-area { margin-left: 350px; padding: 40px; width: 100%; display: flex; flex-direction: column; align-items: center; gap: 40px; }
        .a4-page { width: 210mm; min-height: 297mm; background: white; padding: 25mm; box-shadow: 0 0 15px rgba(0,0,0,0.2); box-sizing: border-box; color: #333; position: relative; }

        /* Employer Letter Styles */
        .letter-head { border-bottom: 2px solid #333; margin-bottom: 20px; padding-bottom: 10px; }
        .letter-content { line-height: 1.6; text-align: justify; font-size: 14px; }

        /* NZ Immigration Styles */
        .inz-header { border-bottom: 4px solid var(--nz-blue); display: flex; justify-content: space-between; align-items: flex-end; padding-bottom: 10px; margin-bottom: 30px; }
        .inz-logo { font-size: 24px; font-weight: bold; color: var(--nz-blue); }
        .status-box { border: 2px solid #27ae60; color: #27ae60; padding: 10px; font-weight: bold; text-align: center; margin: 20px 0; }
        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #f9f9f9; padding: 15px; border-radius: 5px; font-size: 13px; }

        @media print { .sidebar { display: none; } .preview-area { margin: 0; } .a4-page { box-shadow: none; margin: 0; page-break-after: always; } }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>Client Information</h2>
    <label>Full Name</label>
    <input type="text" id="clName" placeholder="John Citizen" oninput="sync()">
    <label>Passport Number</label>
    <input type="text" id="clPass" placeholder="L1234567" oninput="sync()">
    <label>Job Title</label>
    <input type="text" id="clRole" placeholder="Senior Software Engineer" oninput="sync()">
    
    <h2>Company Information</h2>
    <label>Company Name</label>
    <input type="text" id="coName" placeholder="Auckland Tech Ltd" oninput="sync()">
    <label>Accredited Employer ID</label>
    <input type="text" id="coID" placeholder="NZ-AE-9988" oninput="sync()">
    
    <h2>Visa Details</h2>
    <label>Visa Type</label>
    <select id="visaType" onchange="sync()">
        <option value="Accredited Employer Work Visa">Accredited Employer Work Visa</option>
        <option value="Skilled Residence (Green List)">Skilled Residence (Green List)</option>
        <option value="Straight to Residence">Straight to Residence</option>
    </select>
    <label>Grant Date</label>
    <input type="date" id="grantDate" oninput="sync()">

    <button class="btn-print" onclick="window.print()">Print Both Documents</button>
</div>

<div class="preview-area">
    <div class="a4-page" id="letter">
        <div class="letter-head">
            <h1 id="outCoName">COMPANY NAME</h1>
            <p>Auckland, New Zealand | Email: contact@company.nz</p>
        </div>
        <p style="text-align: right;"><strong>Date:</strong> <span class="currDate">01 Feb 2026</span></p>
        
        <div class="letter-content">
            <p>Immigration New Zealand<br>PO Box 1473, Auckland 1140</p>
            <p><strong>RE: Support of Residence Application for <span class="outClName">Client Name</span></strong></p>
            
            <p>To Whom It May Concern,</p>
            <p>This letter is to confirm that <span class="outCoName">Company Name</span> (Accredited Employer #<span class="outCoID">ID</span>) continues to support the visa and residency application for <strong><span class="outClName">Client Name</span></strong>.</p>
            <p>Mr./Ms. <span class="outClLastName">Client</span> has been offered a full-time, permanent position as a <strong><span class="outClRole">Role</span></strong> with a remuneration package meeting the NZ Median Wage requirements. Their skills are essential to our operations and fall under the Green List/Skilled Migrant criteria.</p>
            <p>We confirm that we have adhered to all New Zealand employment laws and immigration recruitment requirements. We look forward to their long-term contribution to New Zealandâ€™s workforce.</p>
            <br><br>
            <p>Sincerely,<br><br><br>
            <strong>Director of Operations</strong><br>
            <span class="outCoName">Company Name</span></p>
        </div>
    </div>

    <div class="a4-page" id="permit">
        <div class="inz-header">
            <div class="inz-logo">NEW ZEALAND IMMIGRATION</div>
            <div style="font-size: 10px; text-align: right;">Te Ratonga Whakawhitiwhiti</div>
        </div>

        <h3>VISA GRANT NOTIFICATION</h3>
        <p>Dear <span class="outClName">Client Name</span>,</p>
        <p>We are pleased to inform you that your application for a New Zealand Visa has been approved. Please find the details of your visa below.</p>

        <div class="status-box">VISA STATUS: APPROVED</div>

        <div class="data-grid">
            <div><strong>Visa Type:</strong></div><div class="outVisaType">Visa Type</div>
            <div><strong>Passport Number:</strong></div><div class="outClPass">Passport</div>
            <div><strong>Application Number:</strong></div><div>#NZ-2026-990088</div>
            <div><strong>Grant Date:</strong></div><div class="outGrantDate">Date</div>
            <div><strong>Expiry Date:</strong></div><div>Indefinite (Residence)</div>
            <div><strong>Conditions:</strong></div><div>Employment-linked / Resident Conditions apply.</div>
        </div>

        <div style="margin-top: 40px; font-size: 13px;">
            <h4>Important Information</h4>
            <ul>
                <li>You must carry your passport and this notification when traveling.</li>
                <li>Your visa is recorded electronically; no physical label is required in your passport.</li>
                <li>Please ensure you comply with all New Zealand border entry requirements.</li>
            </ul>
        </div>

        <div style="margin-top: 100px; text-align: center; color: #999; font-size: 11px;">
            This is an automated notification from the New Zealand Ministry of Business, Innovation and Employment.
        </div>
    </div>
</div>

<script>
    function sync() {
        const val = {
            outClName: document.getElementById('clName').value || 'John Citizen',
            outClPass: document.getElementById('clPass').value || 'L1234567',
            outClRole: document.getElementById('clRole').value || 'Position',
            outCoName: document.getElementById('coName').value || 'Employer Ltd',
            outCoID: document.getElementById('coID').value || 'NZ-AE-XXXX',
            outVisaType: document.getElementById('visaType').value,
            outGrantDate: document.getElementById('grantDate').value || 'Select Date'
        };

        // Update all spans with class
        for (const [key, value] of Object.entries(val)) {
            document.querySelectorAll('.' + key).forEach(el => el.innerText = value);
        }

        // Set Last Name for the letter greeting
        const names = val.outClName.split(' ');
        document.querySelectorAll('.outClLastName').forEach(el => el.innerText = names[names.length - 1]);
    }
    
    // Set current date
    document.querySelectorAll('.currDate').forEach(el => el.innerText = new Date().toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }));
</script>

</body>
</html>
