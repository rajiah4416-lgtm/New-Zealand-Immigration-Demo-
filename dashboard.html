<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Irish Immigration Service | Case Management</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root { --ireland-green: #169b62; --ireland-orange: #ff883e; --ireland-blue: #003366; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background: #f0f2f0; color: #333; }
        
        /* Top Branding */
        .top-nav { background: var(--ireland-blue); color: white; padding: 10px 5%; display: flex; justify-content: space-between; font-size: 0.8rem; border-bottom: 4px solid var(--ireland-green); }
        header { background: white; padding: 20px 5%; display: flex; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .logo-box { display: flex; align-items: center; }
        .flag-stripe { width: 10px; height: 50px; }
        
        /* Dashboard Container */
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .grid { display: grid; grid-template-columns: 350px 1fr; gap: 30px; }
        
        /* Form & List Styling */
        .panel { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border-left: 5px solid var(--ireland-green); }
        h2 { color: var(--ireland-blue); font-size: 1.2rem; margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.75rem; font-weight: bold; margin-bottom: 5px; color: #666; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        
        .btn-submit { background: var(--ireland-green); color: white; border: none; padding: 12px; width: 100%; cursor: pointer; font-weight: bold; border-radius: 4px; margin-top: 10px; }
        .btn-submit:hover { background: #128052; }

        /* Client Table */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85rem; }
        th { background: #f8f9fa; text-align: left; padding: 12px; border-bottom: 2px solid #eee; color: var(--ireland-blue); }
        td { padding: 12px; border-bottom: 1px solid #eee; }
        
        /* Status Badges */
        .badge { padding: 4px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold; text-transform: uppercase; }
        .approved { background: #e6fffa; color: #234e52; border: 1px solid #b2f5ea; }
        .rejected { background: #fff5f5; color: #822727; border: 1px solid #feb2b2; }
        .waiting { background: #fffaf0; color: #7b341e; border: 1px solid #fbd38d; }
    </style>
</head>
<body>

<div class="top-nav">
    <div id="live-clocks">Dublin: --:-- | Local: --:--</div>
    <div>Department of Justice - Immigration Service Delivery</div>
</div>

<header>
    <div class="logo-box">
        <div style="background:#169b62" class="flag-stripe"></div>
        <div style="background:#fff; border:1px solid #eee" class="flag-stripe"></div>
        <div style="background:#ff883e" class="flag-stripe"></div>
        <div style="margin-left: 15px;">
            <h1 style="margin:0; font-size: 1.5rem; letter-spacing: -1px;">An tSeirbh√≠s Inimirce</h1>
            <p style="margin:0; font-size: 0.9rem; color: #666;">Immigration Service Delivery</p>
        </div>
    </div>
</header>

<div class="container">
    <div class="grid">
        <div class="panel">
            <h2>Client Registration</h2>
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="name" placeholder="John Doe">
            </div>
            <div class="form-group">
                <label>Passport Number</label>
                <input type="text" id="passport" placeholder="L1234567">
            </div>
            <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" id="dob">
            </div>
            <div class="form-group">
                <label>Visa Reference Number</label>
                <input type="text" id="visa_no" placeholder="IRE-990022">
            </div>
            <div class="form-group">
                <label>Decision Status</label>
                <select id="status">
                    <option value="waiting">Waiting / Pending</option>
                    <option value="approved">Approved</option>
                    <option value="rejected">Rejected</option>
                </select>
            </div>
            <button class="btn-submit" onclick="addClient()">Add to Immigration Ledger</button>
        </div>

        <div class="panel">
            <h2>Active Case Ledger</h2>
            <table id="clientTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Passport</th>
                        <th>Visa No.</th>
                        <th>DOB</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="clientBody">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // Live Dublin Time Logic
    function updateClocks() {
        const now = new Date();
        const dublin = new Intl.DateTimeFormat('en-GB', { 
            hour: '2-digit', minute: '2-digit', second: '2-digit', 
            timeZone: 'Europe/Dublin', hour12: false 
        }).format(now);
        const local = now.toLocaleTimeString('en-GB', { hour12: false });
        document.getElementById('live-clocks').innerText = `Dublin: ${dublin} | Local: ${local}`;
    }
    setInterval(updateClocks, 1000);

    // Client Management Logic
    let clients = [];

    function addClient() {
        const client = {
            name: document.getElementById('name').value,
            passport: document.getElementById('passport').value,
            dob: document.getElementById('dob').value,
            visa: document.getElementById('visa_no').value,
            status: document.getElementById('status').value
        };

        if(!client.name || !client.passport) return alert("Please fill basic info");

        clients.push(client);
        renderTable();
        clearForm();
    }

    function renderTable() {
        const body = document.getElementById('clientBody');
        body.innerHTML = "";
        
        clients.forEach((c, index) => {
            const row = `<tr>
                <td><strong>${c.name.toUpperCase()}</strong></td>
                <td>${c.passport}</td>
                <td>${c.visa}</td>
                <td>${c.dob}</td>
                <td><span class="badge ${c.status}">${c.status}</span></td>
                <td><button onclick="downloadLetter(${index})" style="cursor:pointer; font-size:10px;">Letter</button></td>
            </tr>`;
            body.innerHTML += row;
        });
    }

    function clearForm() {
        document.querySelectorAll('input').forEach(i => i.value = "");
    }

    // PDF Generation for Official Letter
    function downloadLetter(index) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const c = clients[index];
        
        doc.setFillColor(22, 155, 98); doc.rect(0, 0, 210, 20, 'F');
        doc.setTextColor(255, 255, 255); doc.text("Immigration Service Delivery - Ireland", 10, 13);
        
        doc.setTextColor(0, 0, 0);
        doc.setFontSize(10);
        doc.text(`Date: ${new Date().toLocaleDateString()}`, 150, 40);
        doc.text(`Reference: ${c.visa}`, 10, 40);
        
        doc.setFont("helvetica", "bold");
        doc.text(`RE: VISA APPLICATION DECISION - ${c.status.toUpperCase()}`, 10, 60);
        
        doc.setFont("helvetica", "normal");
        doc.text(`Applicant Name: ${c.name}`, 10, 80);
        doc.text(`Passport: ${c.passport}`, 10, 90);
        
        let msg = c.status === "approved" ? "We are pleased to inform you..." : 
                  c.status === "rejected" ? "We regret to inform you that your application was unsuccessful..." :
                  "Your application is currently under review by an officer.";
                  
        doc.text(msg, 10, 110);
        doc.save(`Ireland_Decision_${c.name}.pdf`);
    }
</script>
</body>
</html>
