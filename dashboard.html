<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <title>Irish Immigration - ISD Portal</title>
    <style>
        /* OFFICIAL IRISH BRAND COLORS */
        :root {
            --ie-green: #169B62;   /* Flag Green */
            --ie-orange: #FF883E;  /* Flag Orange */
            --ie-white: #FFFFFF;
            --ie-navy: #002d5a;    /* Govt Navy */
            --ie-bg: #f4f4f4;
        }

        body { font-family: "Lato", "Arial", sans-serif; background-color: var(--ie-bg); margin: 0; }

        /* HEADER - IRISH EMBASSY STYLE */
        .ie-header {
            background-color: var(--ie-navy);
            color: white;
            padding: 15px 8%;
            border-bottom: 6px solid var(--ie-green);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .flag-box {
            display: inline-flex;
            width: 60px;
            height: 30px;
            border: 1px solid #ccc;
        }
        .green { background: var(--ie-green); flex: 1; }
        .white { background: var(--ie-white); flex: 1; }
        .orange { background: var(--ie-orange); flex: 1; }

        .time-display { font-size: 14px; font-weight: bold; text-align: right; }

        /* DASHBOARD ELEMENTS */
        .container { padding: 30px 8%; }
        .status-pill { padding: 4px 12px; border-radius: 20px; font-weight: bold; font-size: 13px; }
        .status-approval { background: #d4edda; color: #155724; }
        .status-refusal { background: #f8d7da; color: #721c24; }
        .status-waiting { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>

<header class="ie-header">
    <div>
        <h1 style="margin:0; font-size: 22px;">Government of Ireland | <small>Immigration Service Delivery</small></h1>
    </div>
    <div style="display: flex; align-items: center; gap: 20px;">
        <div class="time-display" id="ieTime">Loading Ireland Time...</div>
        <div class="flag-box">
            <div class="green"></div><div class="white"></div><div class="orange"></div>
        </div>
    </div>
</header>

<div class="container">
    <div class="card" style="margin-bottom: 30px; background: white; padding: 25px; border-left: 10px solid var(--ie-green);">
        <h2 style="margin-top:0;">Visa Application Entry</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
            <div>
                <label class="label">Client Full Name</label>
                <input type="text" id="name" class="input" placeholder="e.g. Shoaib Muhammad">
                
                <label class="label">Gender</label>
                <select id="gender" class="input">
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            <div>
                <label class="label">Passport Number</label>
                <input type="text" id="passport" class="input" placeholder="e.g. HN5199602">
                
                <label class="label">Visa Category</label>
                <select id="visaCat" class="input">
                    <option value="Critical Skills Employment">Critical Skills Employment</option>
                    <option value="General Employment">General Employment</option>
                    <option value="Study Visa">Study Visa</option>
                    <option value="Tourism/Visit">Tourism/Visit</option>
                    <option value="Join Family">Join Family</option>
                </select>
            </div>
            <div>
                <label class="label">Start Date of Processing</label>
                <input type="date" id="pStart" class="input">
                
                <label class="label">Application Decision</label>
                <select id="vStatus" class="input">
                    <option value="Waiting">Waiting (In Progress)</option>
                    <option value="Approval">Visa Approved</option>
                    <option value="Refusal">Visa Refused</option>
                </select>
            </div>
        </div>
        <button onclick="saveIrishClient()" class="btn" style="background: var(--ie-navy); width: 100%;">SYNC WITH IRISH EMBASSY DATABASE</button>
    </div>

    <div class="card" style="background: white; padding: 25px;">
        <h3>Irish Immigration Records</h3>
        <table style="width:100%; border-collapse: collapse;">
            <thead>
                <tr style="text-align: left; border-bottom: 3px solid var(--ie-navy);">
                    <th>Client Name</th><th>Passport</th><th>Category</th><th>Status</th><th>Action</th>
                </tr>
            </thead>
            <tbody id="irishTableBody"></tbody>
        </table>
    </div>
</div>

<script>
    // Live Ireland Time Function
    function updateIEClock() {
        const options = { timeZone: "Europe/Dublin", hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true, weekday: 'long', day: 'numeric', month: 'short' };
        document.getElementById('ieTime').innerHTML = "Dublin Time: " + new Date().toLocaleString('en-IE', options);
    }
    setInterval(updateIEClock, 1000);

    let irishClients = JSON.parse(localStorage.getItem('ie_visa_db')) || [];

    function saveIrishClient() {
        const data = {
            name: document.getElementById('name').value,
            pass: document.getElementById('passport').value,
            gender: document.getElementById('gender').value,
            category: document.getElementById('visaCat').value,
            start: document.getElementById('pStart').value,
            status: document.getElementById('vStatus').value
        };
        irishClients.push(data);
        localStorage.setItem('ie_visa_db', JSON.stringify(irishClients));
        renderIrish();
    }

    function renderIrish() {
        const body = document.getElementById('irishTableBody');
        body.innerHTML = '';
        irishClients.forEach((c, i) => {
            const statusClass = c.status === 'Approval' ? 'status-approval' : (c.status === 'Refusal' ? 'status-refusal' : 'status-waiting');
            body.innerHTML += `<tr style="border-bottom: 1px solid #ddd;">
                <td style="padding:15px;"><strong>${c.name}</strong></td>
                <td>${c.pass}</td>
                <td>${c.category}</td>
                <td><span class="status-pill ${statusClass}">${c.status}</span></td>
                <td><button onclick="genIrishPDF(${i})" style="border:none; color:var(--ie-navy); background:none; text-decoration:underline; cursor:pointer;">Download Decision</button></td>
            </tr>`;
        });
    }

    function genIrishPDF(i) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const c = irishClients[i];
        
        doc.setFontSize(20);
        doc.setTextColor(22, 155, 98); // Irish Green
        doc.text("An Roinn Dl√≠ agus Cirt", 15, 20); // Dept of Justice
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.text("Department of Justice | Immigration Service Delivery", 15, 26);
        
        doc.autoTable({
            startY: 40,
            head: [['Field', 'Official Record Detail']],
            body: [
                ['Full Name', c.name],
                ['Passport #', c.pass],
                ['Gender', c.gender],
                ['Visa Category', c.category],
                ['Processing Start', c.start],
                ['Current Status', c.status.toUpperCase()]
            ],
            theme: 'striped',
            headStyles: { fillColor: [0, 45, 90] }
        });
        
        doc.text("Official verification of this record is required via the ISD online portal.", 15, doc.lastAutoTable.finalY + 15);
        doc.save(`${c.name}_Irish_Visa_Decision.pdf`);
    }
    renderIrish();
</script>
</body>
</html>
