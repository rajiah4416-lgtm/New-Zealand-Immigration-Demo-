<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NZ Immigration & HR Sponsorship Suite - Official</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style id="themeStyles">
        :root { 
            --inz-black: #1a1a1a; 
            --inz-blue: #00247d; 
            --inz-silver: #C0C0C0;
            --page-bg: #f4f4f6; /* Professional Silver-Grey instead of white */
            --accent: #00247d;
        }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #2c3e50; margin: 0; display: flex; }
        
        .sidebar { width: 380px; background: #111; color: white; padding: 25px; height: 100vh; overflow-y: auto; box-sizing: border-box; position: fixed; border-right: 4px solid var(--inz-blue); z-index: 1000; }
        .sidebar h2 { font-size: 13px; color: var(--inz-silver); text-transform: uppercase; border-bottom: 1px solid #333; padding-bottom: 5px; margin-top: 20px; }
        label { display: block; margin-top: 10px; font-size: 10px; text-transform: uppercase; color: #888; }
        input, select { width: 100%; padding: 8px; margin-top: 5px; border-radius: 4px; border: none; background: #222; color: white; font-size: 13px; }
        
        .preview-area { margin-left: 380px; padding: 40px; width: 100%; display: flex; flex-direction: column; align-items: center; }
        
        /* THE A4 PAGE - PIGROOT COLOR CHANGE */
        .a4-page { 
            width: 210mm; min-height: 297mm; 
            background: var(--page-bg); 
            padding: 20mm; 
            box-shadow: 0 0 25px rgba(0,0,0,0.5); 
            box-sizing: border-box; color: #222; 
            position: relative;
            border-top: 8px solid var(--inz-black);
        }

        .nz-header { text-align: center; border-bottom: 1px solid var(--inz-silver); padding-bottom: 20px; margin-bottom: 30px; }
        .nz-header h1 { margin: 10px 0; font-size: 24px; letter-spacing: 2px; color: var(--inz-black); }
        
        .data-table { width: 100%; border-collapse: collapse; margin: 15px 0; background: white; }
        .data-table td { padding: 12px; border: 1px solid #ddd; font-size: 13px; }
        .label-cell { background: #eee; font-weight: bold; width: 35%; color: var(--inz-blue); text-transform: uppercase; font-size: 11px; }

        .legal-text { font-style: italic; font-size: 12px; line-height: 1.6; color: #444; border-left: 3px solid var(--inz-blue); padding-left: 15px; margin: 30px 0; }

        .signature-area { margin-top: 40px; display: flex; justify-content: space-between; align-items: flex-end; }
        #sig-preview { max-width: 150px; max-height: 80px; display: block; margin-bottom: 5px; filter: grayscale(1) contrast(1.2); }
        
        .qr-box { text-align: center; font-size: 9px; font-weight: bold; color: var(--inz-blue); }

        button.print-btn { width: 100%; padding: 15px; margin-top: 25px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; background: var(--inz-blue); color: white; }

        @media print { .sidebar { display: none; } .preview-area { margin: 0; } .a4-page { box-shadow: none; border: none; } }
    </style>
</head>
<body>

<div class="sidebar">
    <h2>üé® Official INZ Branding</h2>
    <label>Theme Preset</label>
    <select id="colorTheme" onchange="applyOfficialColors()">
        <option value="official">Official INZ (Navy/Black/Silver)</option>
        <option value="midnight">Midnight Professional</option>
        <option value="prestige">Prestige Gold & Charcoal</option>
    </select>

    <h2>‚úíÔ∏è Professional Polish</h2>
    <label>Tone Enhancer</label>
    <select id="toneSelect" onchange="sync()">
        <option value="formal">Standard Formal</option>
        <option value="premium">Premium Legalistic (Beautiful Words)</option>
    </select>

    <h2>‚úçÔ∏è Digital Signature</h2>
    <label>Upload HR Signature (PNG/JPG)</label>
    <input type="file" id="sigInput" accept="image/*" onchange="loadSignature(event)">

    <h2>üìÖ Timeline</h2>
    <label>Issuance Date</label>
    <input type="date" id="inIssueDate" oninput="sync()">

    <h2>üë§ Applicant</h2>
    <input type="text" id="inClName" placeholder="Full Name" oninput="sync()">
    <input type="text" id="inRef" placeholder="INZ Reference Number" oninput="sync()">
    
    <h2>üè¢ Employer</h2>
    <input type="text" id="inCoName" placeholder="Company Name" oninput="sync()">
    <input type="text" id="inJob" placeholder="Job Title" oninput="sync()">
    
    <button class="print-btn" onclick="window.print()">Generate Official PDF</button>
</div>

<div class="preview-area">
    <div class="a4-page" id="docPage">
        <div class="nz-header">
            <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Flag_of_New_Zealand.svg" style="width: 80px;">
            <h1>IMMIGRATION NEW ZEALAND</h1>
            <p style="font-size: 11px;">GOVERNMENT PORTAL VERIFICATION RECORD ‚Ä¢ <span class="outIssueDate">---</span></p>
        </div>

        <table class="data-table">
            <tr><td class="label-cell">Reference Number</td><td class="outRef" style="font-weight:bold; letter-spacing:1px;">---</td></tr>
            <tr><td class="label-cell">Visa Holder</td><td class="outClName">---</td></tr>
            <tr><td class="label-cell">Sponsoring Body</td><td class="outCoName">---</td></tr>
            <tr><td class="label-cell">Position Designation</td><td class="outJob">---</td></tr>
        </table>

        <div class="legal-text" id="legalPolish">
            The sponsoring organization hereby affirms its commitment to the visa maintenance of the applicant under the Accredited Employer Work Visa framework.
        </div>

        <div class="signature-area">
            <div>
                <img id="sig-preview" src="" style="display:none;">
                <div style="border-top: 1px solid #000; width: 200px; padding-top: 5px;">
                    <strong style="font-size: 13px;">OFFICIALLY SIGNED</strong><br>
                    <span style="font-size: 11px; color: #666;">HR COMPLIANCE DIVISION</span>
                </div>
            </div>
            <div class="qr-box">
                <div id="hrQRCode"></div>
                VERIFY AUTHENTICITY
            </div>
        </div>
        
        <div style="position: absolute; bottom: 20mm; left: 20mm; font-size: 9px; color: #999;">
            ¬© 2026 Immigration New Zealand Compliance Office. Document electronically generated.
        </div>
    </div>
</div>

<script>
    let hrQR = new QRCode(document.getElementById("hrQRCode"), { width: 80, height: 80 });

    function loadSignature(event) {
        const output = document.getElementById('sig-preview');
        output.src = URL.createObjectURL(event.target.files[0]);
        output.style.display = 'block';
    }

    function applyOfficialColors() {
        const theme = document.getElementById('colorTheme').value;
        const r = document.documentElement.style;
        if(theme === 'official') {
            r.setProperty('--inz-blue', '#00247d');
            r.setProperty('--inz-black', '#1a1a1a');
            r.setProperty('--page-bg', '#f4f4f6');
        } else if(theme === 'midnight') {
            r.setProperty('--inz-blue', '#2c3e50');
            r.setProperty('--inz-black', '#000000');
            r.setProperty('--page-bg', '#ebebeb');
        } else if(theme === 'prestige') {
            r.setProperty('--inz-blue', '#996515');
            r.setProperty('--inz-black', '#222');
            r.setProperty('--page-bg', '#fcfcfc');
        }
    }

    function sync() {
        const tone = document.getElementById('toneSelect').value;
        const co = document.getElementById('inCoName').value || 'The Company';
        
        const polish = {
            formal: `This letter confirms that ${co} supports the visa application for the mentioned individual and accepts all standard sponsorship responsibilities.`,
            premium: `Be it known that ${co}, an Accredited Employer under New Zealand statutes, formally declares its unwavering sponsorship of the applicant. We attest to the veracity of the employment terms and pledge full adherence to the Immigration Act 2009 to ensure a seamless professional transition.`
        };

        document.getElementById('legalPolish').innerText = polish[tone];
        
        const fields = {
            outIssueDate: document.getElementById('inIssueDate').value || 'PENDING',
            outClName: document.getElementById('inClName').value || '---',
            outRef: document.getElementById('inRef').value || '---',
            outCoName: co,
            outJob: document.getElementById('inJob').value || '---'
        };

        for (const [key, value] of Object.entries(fields)) {
            document.querySelectorAll('.' + key).forEach(el => el.innerText = value);
        }

        hrQR.makeCode(`VERIFY|${fields.outRef}|${fields.outCoName}|${fields.outIssueDate}`);
    }

    sync();
</script>
</body>
</html>
